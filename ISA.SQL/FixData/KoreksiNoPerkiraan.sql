USE ISAFinance
GO

/*******************************************
Created By	: Yogi
Date		: Nov 02, 2012 
Description	: Change Several NoPerkiraan in JournalDetail
Modified By	:
-------------------------------------------- 
{date}			{name}		{description}
Nov 02, 2012	Yogi		{intial created}	
********************************************/

IF OBJECT_ID('tempdb..#TEMP') IS NOT NULL
DROP TABLE #TEMP

CREATE TABLE #TEMP(
OldNoPerkiraan VARCHAR(12),
NewNoPerkiraan VARCHAR(12)
)

INSERT INTO #TEMP VALUES ('110899', '110819')
INSERT INTO #TEMP VALUES ('110899101', '110819101')
INSERT INTO #TEMP VALUES ('110899102', '110819102')
INSERT INTO #TEMP VALUES ('110899103', '110819103')
INSERT INTO #TEMP VALUES ('110899104', '110819104')
INSERT INTO #TEMP VALUES ('110899105', '110819105')
INSERT INTO #TEMP VALUES ('110899106', '110819106')
INSERT INTO #TEMP VALUES ('110899107', '110819107')
INSERT INTO #TEMP VALUES ('110899108', '110819108')
INSERT INTO #TEMP VALUES ('110899109', '110819109')
INSERT INTO #TEMP VALUES ('110899110', '110819110')
INSERT INTO #TEMP VALUES ('110899111', '110819111')
INSERT INTO #TEMP VALUES ('110899112', '110819112')
INSERT INTO #TEMP VALUES ('110899113', '110819113')
INSERT INTO #TEMP VALUES ('110899114', '110819114')
INSERT INTO #TEMP VALUES ('110899115', '110819115')
INSERT INTO #TEMP VALUES ('110899116', '110819116')
INSERT INTO #TEMP VALUES ('110899117', '110819117')
INSERT INTO #TEMP VALUES ('110899118', '110819118')
INSERT INTO #TEMP VALUES ('110899119', '110819119')
INSERT INTO #TEMP VALUES ('110899120', '110819120')
INSERT INTO #TEMP VALUES ('110899121', '110819121')
INSERT INTO #TEMP VALUES ('110899122', '110819122')
INSERT INTO #TEMP VALUES ('110899123', '110819123')
INSERT INTO #TEMP VALUES ('110899124', '110819124')
INSERT INTO #TEMP VALUES ('110899125', '110819125')
INSERT INTO #TEMP VALUES ('111390', '110820')
INSERT INTO #TEMP VALUES ('111390101', '110820101')
INSERT INTO #TEMP VALUES ('111390102', '110820102')
INSERT INTO #TEMP VALUES ('111399', '110829')
INSERT INTO #TEMP VALUES ('111399111', '110829111')
INSERT INTO #TEMP VALUES ('111830', '110891')
INSERT INTO #TEMP VALUES ('111830100', '110891100')
INSERT INTO #TEMP VALUES ('111830101', '110891101')
INSERT INTO #TEMP VALUES ('111830102', '110891102')
INSERT INTO #TEMP VALUES ('111830103', '110891103')
INSERT INTO #TEMP VALUES ('111830104', '110891104')
INSERT INTO #TEMP VALUES ('111830105', '110891105')
INSERT INTO #TEMP VALUES ('111830106', '110891106')
INSERT INTO #TEMP VALUES ('111840', '110892')
INSERT INTO #TEMP VALUES ('111840100', '110892100')
INSERT INTO #TEMP VALUES ('111850', '110893')
INSERT INTO #TEMP VALUES ('111850100', '110893100')
INSERT INTO #TEMP VALUES ('111850101', '110893101')
INSERT INTO #TEMP VALUES ('111910', '110894')
INSERT INTO #TEMP VALUES ('111910100', '110894100')
INSERT INTO #TEMP VALUES ('111930', '110895')
INSERT INTO #TEMP VALUES ('111930100', '110895100')
INSERT INTO #TEMP VALUES ('111999', '110899')
INSERT INTO #TEMP VALUES ('111999100', '110899100')
INSERT INTO #TEMP VALUES ('111999111', '110899111')
INSERT INTO #TEMP VALUES ('150210', '150120')
INSERT INTO #TEMP VALUES ('150210100', '150120100')
INSERT INTO #TEMP VALUES ('150210200', '150120200')
INSERT INTO #TEMP VALUES ('150210300', '150120300')
INSERT INTO #TEMP VALUES ('150210500', '150120500')
INSERT INTO #TEMP VALUES ('150310', '150130')
INSERT INTO #TEMP VALUES ('150310100', '150130100')
INSERT INTO #TEMP VALUES ('150310200', '150130200')
INSERT INTO #TEMP VALUES ('150702', '150620')
INSERT INTO #TEMP VALUES ('150702200', '150620200')
INSERT INTO #TEMP VALUES ('150702300', '150620300')
INSERT INTO #TEMP VALUES ('150702500', '150620500')
INSERT INTO #TEMP VALUES ('2300', '2301')
INSERT INTO #TEMP VALUES ('249910', '240299')
INSERT INTO #TEMP VALUES ('249910100', '240299100')
INSERT INTO #TEMP VALUES ('2500', '2500')
INSERT INTO #TEMP VALUES ('250110', '250010')
INSERT INTO #TEMP VALUES ('250111', '250011')
INSERT INTO #TEMP VALUES ('250112', '250012')
INSERT INTO #TEMP VALUES ('250119', '250019')
INSERT INTO #TEMP VALUES ('250130', '250030')
INSERT INTO #TEMP VALUES ('250131', '250031')
INSERT INTO #TEMP VALUES ('250132', '250032')
INSERT INTO #TEMP VALUES ('250139', '250039')
INSERT INTO #TEMP VALUES ('250145', '250045')
INSERT INTO #TEMP VALUES ('8110', '8110')
INSERT INTO #TEMP VALUES ('811110', '811010')
INSERT INTO #TEMP VALUES ('811110100', '811010100')
INSERT INTO #TEMP VALUES ('9110', '9110')
INSERT INTO #TEMP VALUES ('911110', '911010')
INSERT INTO #TEMP VALUES ('911110100', '911010100')

INSERT INTO #TEMP VALUES ('210303100', '210380100')
INSERT INTO #TEMP VALUES ('755999010', '759999010')


SET XACT_ABORT ON
BEGIN TRANSACTION

UPDATE JournalDetail WITH (UPDLOCK, TABLOCK)
SET NoPerkiraan = B.NewNoPerkiraan 
FROM JournalDetail A INNER JOIN
#TEMP B ON A.NoPerkiraan = B.OldNoPerkiraan

UPDATE ClosingGL WITH (UPDLOCK, TABLOCK)
SET NoPerkiraan = B.NewNoPerkiraan 
FROM ClosingGL A INNER JOIN
#TEMP B ON A.NoPerkiraan = B.OldNoPerkiraan

UPDATE BankDetail WITH (UPDLOCK, TABLOCK)
SET NoPerkiraan = B.NewNoPerkiraan 
FROM BankDetail A INNER JOIN
#TEMP B ON A.NoPerkiraan = B.OldNoPerkiraan

UPDATE Bank WITH (UPDLOCK, TABLOCK)
SET NoPerkiraan = B.NewNoPerkiraan 
FROM Bank A INNER JOIN
#TEMP B ON A.NoPerkiraan = B.OldNoPerkiraan


UPDATE PerkiraanKoneksiDetail WITH (UPDLOCK, TABLOCK)
SET NoPerkiraan = B.NewNoPerkiraan 
FROM PerkiraanKoneksiDetail A INNER JOIN
#TEMP B ON A.NoPerkiraan = B.OldNoPerkiraan

UPDATE Giro WITH (UPDLOCK, TABLOCK)
SET NoPerkiraan = B.NewNoPerkiraan 
FROM Giro A INNER JOIN
#TEMP B ON A.NoPerkiraan = B.OldNoPerkiraan

UPDATE DKNDetail WITH (UPDLOCK, TABLOCK)
SET NoPerkiraan = B.NewNoPerkiraan 
FROM DKNDetail A INNER JOIN
#TEMP B ON A.NoPerkiraan = B.OldNoPerkiraan

UPDATE BuktiDetail WITH (UPDLOCK, TABLOCK)
SET NoPerkiraan = B.NewNoPerkiraan 
FROM BuktiDetail A INNER JOIN
#TEMP B ON A.NoPerkiraan = B.OldNoPerkiraan

COMMIT TRANSACTION
SET XACT_ABORT OFF